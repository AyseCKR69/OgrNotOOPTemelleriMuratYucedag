-------------------PROSEDÜRLER-----------------
-ÖĞRENCİ TABLOSU İÇİN- 
-ÖĞRENCİ LİSTESİ-

CREATE PROCEDURE OGRENCILISTESI
AS
SELECT * FROM TBLOGRENCI

-ÖĞRENCİ EKLEME-
--id yi almadık otomatik artan old için 

CREATE PROCEDURE OGRENCIEKLE
@AD VARCHAR(20),
@SOYAD VARCHAR(30),
@FOTOGRAF VARCHAR(50),
@KULUPID smallint
AS
İNSERT iNTO TBLOGRENCI (AD,SOYAD,FOTOGRAF,KULUPID)
VALUES
(@AD,@SOYAD,@FOTOGRAF,@KULUPID)

-GÜNCELLEME-

CREATE PROCEDURE OGRENCIGUNCELLE
@AD VARCHAR(20),
@SOYAD VARCHAR(30),
@FOTOGRAF VARCHAR(50),
@KULUPID smallint,
@ID int
AS 
UPDATE TBLOGRENCI SET AD=@AD,SOYAD=@SOYAD,FOTOGRAF=@FOTOGRAF,KULUPID=@KULUPID
WHERE ID=@ID

-SİLME-

CREATE PROCEDURE OGRENCISIL
@ID int
AS
DELETE FROM TBLOGRENCI WHERE ID=@ID 

-KULÜP TAPLOSU İÇİN PROSEDÜRLER-
-LİSTESİ-

CREATE PROCEDURE KULUPLISTESI
AS
SELECT * FROM TBLKULUP

-KULUP EKLE-

CREATE PROCEDURE KULUPEKLE
@KULUPAD varchar(20)
AS
INSERT INTO TBLKULUP (KULUPAD) VALUES (@KULUPAD)

-GÜNCELLE-

CREATE PROCEDURE KULUPGUNCELLE
@KULUPAD VARCHAR(20),
@KULUPID TINYINT
AS
UPDATE TBLKULUP SET KULUPAD=@KULUPAD WHERE KULUPID=@KULUPID

-SİLME-

CREATE PROCEDURE KULUPSIL
@KULUPID TINYINT
AS
DELETE FROM TBLKULUP WHERE KULUPID=@KULUPID

EXECUTE KULUPLISTESI // ÇAĞIRIYORUZ
EXECUTE OGRENCILISTESI 

--TRİGGER-- HOCANIN YAZDIĞI AMA ÇALIŞMADI--
ÖĞRENCİ TABLOSUNA KAYIT EKLENDİĞİNDE İD Yİ NOTLAR TABLOSUNA EKLESİN

CREATE TRIGGER OGRENCINOT
ON TBLOGRENCI --HANGİ TABLODA OLACAĞI
AFTER INSERT -- NEYDEN SONRA OLACAĞI
AS
DECLARE @ID SMALLINT -- TANIMLADIK
SELECT @ID=ID FROM INSERTED --TANIMLADIĞIMIZ DEĞERE ÖĞRENCİ TABLOSUNDAKİ ID Yİ ATADIK KAYIT EKLENDİĞİNDEKİ ID 
INSERT INTO TBLNOTLAR (OGRID) VALUES (@ID) -- BURADA DA HANGİ TABLONUN ETKİLENECEĞİNİ YAZDIK NE OLACAĞINI YAZDIK

--çözüm--
CREATE TRIGGER OGRENCINOT
ON TBLOGRENCI
AFTER INSERT
AS
DECLARE @ID INT
SELECT @ID=ID FROM INSERTED
SET IDENTITY_INSERT TBLNOTLAR ON
INSERT INTO TBLNOTLAR (OGRID) VALUES (@ID)
SET IDENTITY_INSERT TBLNOTLAR OFF;

----------NOT GUNCELLE PROSEDURU--
CREATE PROCEDURE NOTGUNCELLE
@OGRID SMALLINT,
@SINAV1 TINYINT,
@SINAV2 TINYINT,
@SINAV3 TINYINT,
@PROJE TINYINT,
@ORTALAMA DECIMAL(18,2),
@DURUM BIT
AS
UPDATE TBLNOTLAR SET SINAV1=@SINAV1,
                     SINAV2=@SINAV2,
                     SINAV3=@SINAV3,
		     PROJE=@PROJE,
		     ORTALAMA=@ORTALAMA,
		     DURUM=@DURUM
		     WHERE OGRID=@OGRID

--NOT LISTESI--
CREATE PROCEDURE NOTLISTESI
AS
SELECT OGRID,AD,SOYAD,SINAV1,SINAV2,SINAV3,PROJE,ORTALAMA,DURUM
FROM TBLNOTLAR INNER JOIN TBLOGRENCI
ON TBLOGRENCI.ID=TBLNOTLAR.OGRID